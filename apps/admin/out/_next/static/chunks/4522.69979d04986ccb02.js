(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4522],{72555:function(e,t,n){"use strict";n.r(t),t.default={src:"/admin/_next/static/media/logo.12766b1b.png",height:572,width:572,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAdVBMVEUBAgIAAgIBAQEAAQEBAgIBAQEBAQEAAQEAAQEAAQEAAQEBAgIBAQEBAgIBAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQEAAQGs73SBAAAAJ3RSTlMAAAAAAQEEBgcNDxsbHR0vMTU2P0BKX2RmZ3J0e31/goiQkpaXnZ4UCFX1AAAARUlEQVR42gVABRKAIBBcXQM74QxEDPz/Ex3EbJ+3IZBKGMYgCYwHCW+wzJlz+bRCdHSckRaIZVHSCtR+V/W1KZD9FzryB5lZBEw3DyQBAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8}},74522:function(e,t,n){"use strict";let o,i,r;n.r(t),n.d(t,{default:function(){return e0},newVisualUiContext:function(){return ee},useVisualUi:function(){return en},useVisualUiAtom:function(){return et},useVisualUiComms:function(){return ei}});var l=n(52322),s=n(2784),a=n(5632),d=n(8293),c=n(7771),u=n(18299),p=n(28316),h=n(60163),f=n(50637),x=n(40178),g=n(81267),m=n(9944),v=n(55050),y=n(32678),b=n(16399);let E={dark:{nodeBackgroundColor:"#252526",interactiveHoverColor:"#2C446A",interactiveHoverColorDarken:"#2C446A",interactiveColor:"#4772b3",inputBackgroundColor:"#404040",secondaryBackground:"#191919",borderColor:"grey",blockPort:"grey",flowPort:"grey",dataPort:"grey",textColor:"#CCCCCC",dataOutputColor:"grey",nodeBorderColor:"grey",edgeColor:"grey",titleColor:"black",separatorColor:"#424242"},light:{edgeColor:"#888",nodeBackgroundColor:"#fdfdfd",inputBackgroundColor:"white",secondaryBackground:"#E7E7E7",textColor:"#19191A",interactiveColor:"#009AFB",interactiveHoverColor:"#CEE7FE",interactiveHoverColorDarken:"#2773BC",borderColor:"#888",dataOutputColor:"black",blockPort:"#fefefe",flowPort:"#fefefe",dataPort:"#fefefe",nodeBorderColor:"#aaa",disableTextColor:"#acacac",separatorColor:"#D4D4D4",titleColor:"#222"}},C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{resolvedTheme:n}=(0,b.P)(),o={...E[n]};try{let t=o[e];return t}catch(e){return t}};var w=n(23983),k=n(70549),j=e=>{var t;let{name:n,color:o,size:i}=e,r=null!==(t=w[n])&&void 0!==t?t:k.Z;return(0,l.jsx)(r,{color:o,size:i})},A=n(6364),S=n(90251),_=n(83030);let J=e=>{let{name:t,icon:n,selected:o=!1,...i}=e,[r,a]=(0,s.useState)(!1),d=r?C("interactiveColor"):C("textColor");return(0,l.jsxs)("div",{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),...i,style:{cursor:"pointer",justifyContent:"space-between",width:"100%",display:"flex",alignItems:"center",flex:1,alignSelf:"flex-start",padding:"12px",...i.style},children:[(0,l.jsx)("div",{style:{color:d},children:t}),(0,l.jsxs)("div",{children:[n?(0,s.createElement)(n,{color:d,size:16,paddingTop:"2px"}):null,o?(0,l.jsx)(_.Z,{size:16,style:{marginLeft:"10px"},color:d}):null]})]})},I=e=>{let{trigger:t,content:n,onOpenChange:o,...i}=e;return(0,l.jsxs)(S.J2,{allowFlip:!0,onOpenChange:o,...i,children:[(0,l.jsx)(S.J2.Trigger,{children:t}),n?(0,l.jsx)(S.J2.Content,{width:"250px",padding:"$2",paddingRight:"$0",br:"$0",bw:"1px",display:"flex",shadowRadius:"$4",shadowColor:"black",boc:"gray",shadowOpacity:.6,bc:C("nodeBackgroundColor"),maxHeight:"350px",overflow:"scroll",overflowX:"hidden",children:n}):null]})},N=(0,s.forwardRef)((e,t)=>{let{icon:n,iconSize:o=20,selected:i=!1,dynamicIcon:r,...a}=e,[d,c]=(0,s.useState)(!1);return(0,l.jsx)("div",{ref:t,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),...a,style:{cursor:"pointer",padding:"6px",borderRadius:"2px",backgroundColor:i?C("textColor"):"",...a.style},children:r?(0,l.jsx)(j,{name:r,color:i?C("nodeBackgroundColor"):d?C("interactiveColor"):C("textColor"),size:o}):(0,s.createElement)(n,{size:o,color:d?C("interactiveColor"):C("textColor")})})}),P=e=>{var t;let{render:n,onEnableEvents:o,metadata:i}=e,{id:r}=(0,d.Zo)(),{actions:a,query:c,isActive:b}=(0,d.jE)((e,t)=>({isActive:t.getEvent("selected").contains(r)})),{isHover:E,dom:w,name:k,moveable:j,deletable:S,connectors:{drag:_},parent:P,childs:O,nodeAndSiblings:T,nodeId:z,unknown:D,setProp:B,custom:K,props:L,node:R}=(0,d.Zo)(e=>{var t,n,o;return{custom:e.data.custom,unknown:null!==(o=e.data.custom.unknown)&&void 0!==o&&o,nodeId:e.id,isHover:e.events.hovered,dom:e.dom,node:e,name:e.data.custom.displayName||e.data.displayName,moveable:c.node(e.id).isDraggable(),deletable:c.node(e.id).isDeletable()&&c.node(e.id).isDraggable(),parent:e.data.parent,props:e.data.props,childs:e.data.nodes,nodeAndSiblings:(null===(t=e.data)||void 0===t?void 0:t.parent)?c.node(null===(n=e.data)||void 0===n?void 0:n.parent).childNodes():void 0}}),Z=0==O.length,Q=D?"#EF9364":"#2680EB",F="1px solid gray",V=(0,s.useRef)();(0,s.useEffect)(()=>{w&&(b?w.style.boxShadow="inset 0px 0px 0px 2px "+Q:E?w.style.boxShadow="inset 0px 0px 0px 1px "+Q:w.style.boxShadow="")},[w,b,E]);let H=(0,s.useCallback)(e=>{let t;let{top:n,left:o,bottom:i}=e?e.getBoundingClientRect():{top:0,left:0,bottom:0},r=o<5?5:o;var l=document.body,s=document.documentElement,a=Math.max(l.scrollHeight,l.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight);return n>120?t=n-60:a-i>70&&i>60?t=i+10:a-i<120&&i>120?(t=i-55,r=5):t=-2e4,{top:t+"px",left:r+"px"}},[]),M=(0,s.useCallback)(()=>{let{current:e}=V;if(!e)return;let{top:t,left:n}=H(w);e.style.top=t,e.style.left=n},[w,H]);(0,s.useEffect)(()=>{var e,t;return null===(t=document)||void 0===t||null===(e=t.querySelector(".craftjs-renderer"))||void 0===e||e.addEventListener("scroll",M),()=>{var e,t;null===(t=document)||void 0===t||null===(e=t.querySelector(".craftjs-renderer"))||void 0===e||e.removeEventListener("scroll",M)}},[M]);let U=e=>(0,l.jsx)("div",{style:{height:50,borderLeft:F}});return(0,l.jsxs)(l.Fragment,{children:[b?p.createPortal((0,l.jsxs)("div",{id:"my-renderedNode",ref:V,style:{left:H(w).left,top:H(w).top,zIndex:1e31,position:"fixed",backgroundColor:C("nodeBackgroundColor"),border:F,padding:"6px",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center",height:50,pointerEvents:"auto",gap:"6px"},children:[(0,l.jsxs)("div",{style:{fontSize:14,color:C("textColor"),padding:"10px 20px"},children:[k,D?" (Unknown)":""]}),(0,l.jsx)(U,{}),(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",flex:1,gap:"6px",alignItems:"center"},children:[j?(0,l.jsx)(N,{ref:_,style:{cursor:"grab"},title:"Move",icon:h.Z}):null,r!==u.QS&&"ROOT"!=P?(0,l.jsx)(N,{title:"Select parent",onMouseDown:e=>{a.selectNode(P),e.stopPropagation()},icon:f.Z}):null,O.length?(0,l.jsx)(N,{title:"Select first child",icon:x.Z,onMouseDown:e=>{a.selectNode(O[0]),e.stopPropagation()}}):null,(null==T?void 0:T.length)>1?(0,l.jsx)(N,{title:"Select next sibling",icon:g.Z,onMouseDown:e=>{let t=T.indexOf(z),n=(t+1)%T.length,o=T[n];a.selectNode(o),e.stopPropagation()}}):null,(0,l.jsx)(U,{}),K.shortcuts?(0,l.jsxs)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center _gap-6px ",children:[K.shortcuts.map((e,t)=>{var n;let r=null!=e&&!!e.selected&&e.selected(L);return(0,l.jsx)(I,{onOpenChange:o,trigger:(0,l.jsx)(N,{onClick:e.action?()=>e.action({setProp:B,dom:w}):null,selected:r,dynamicIcon:e.icon(L)}),content:e.menu?null===(n=e.menu)||void 0===n?void 0:n.map(e=>(0,l.jsx)(J,{onClick:t=>{t.stopPropagation(),e.action({setProp:B,dom:w,metadata:i,props:L})},selected:null!=e&&!!e.selected&&e.selected(L),name:e.name})):null},t)}),(0,l.jsx)(U,{})]}):null,K.options||Z||S?(0,l.jsx)(I,{onOpenChange:o,trigger:(0,l.jsx)(N,{title:"Options",id:"render-node-options-btn",icon:m.Z}),content:(0,l.jsxs)(l.Fragment,{children:[Z?(0,l.jsx)(J,{onClick:e=>{e.stopPropagation(),a.add([{id:(0,A.Z)(),rules:{...R.rules},data:{...R.data},events:R.events}],P,T.indexOf(z)+1)},icon:v.Z,name:"Duplicate"}):null,null===(t=K.options)||void 0===t?void 0:t.map(e=>(0,l.jsx)(J,{onClick:t=>{t.stopPropagation(),o(!1),e.action({setProp:B,dom:w,metadata:i,props:L})},name:e.name})),S?(0,l.jsx)(J,{id:"render-node-delete-btn",onClick:e=>{e.stopPropagation(),a.delete(r)},icon:y.Z,name:"Delete"}):null]})}):null]})]}),document.querySelector(".page-container")):null,n]})};n(54975);let O=e=>(0,l.jsx)(l.Fragment,{});O.craft={props:{},related:{settings:()=>(0,l.jsx)("div",{})}};let T=e=>(0,l.jsx)(l.Fragment,{children:e.children});T.craft={props:{},related:{settings:()=>(0,l.jsx)("div",{})}};let z=e=>{var t;let{connectors:{connect:n},setProp:o}=(0,d.Zo)(e=>({selected:e.events.selected,custom:e.data.custom}));return(0,l.jsx)("div",{ref:n,style:{minHeight:"30px"},children:null!==(t=e.children)&&void 0!==t?t:"Unknown"})};z.craft={props:{},related:{settings:()=>(0,l.jsx)("div",{})}};var D={craft:{Root:T,Unknown:z,ReactCode:O}},B=n(97729),K=n.n(B),L=n(45054),R=n(85067),Z=n.n(R),Q=n(20477);class F{static parse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Q.IKL({useInMemoryFileSystem:!0,manipulationSettings:{indentationText:Q.xI4.Tab},compilerOptions:{target:Q.H7j.Latest,scriptKind:Q.hVH.TSX,languageVariant:Q.C$L.JSX}});return new F(n.createSourceFile("_temp2.tsx",e,{overwrite:!0}),t)}data(e){e&&this.identifyElements(e);let t=this.getContent(),n=this.toCraftNodes(t);return this.addCustomProps(n)}getContent(){return this.getFirstDescendant("JsxElement")}getFirstDescendant(e){var t,n;let o=Q.lGB[e];return e?null===(t=this.ast)||void 0===t?void 0:t.getFirstDescendantByKind(o):null===(n=this.ast)||void 0===n?void 0:n.getFirstDescendant()}getAllJsxElements(e){let t=this.getAllJsxChildren(e),n=[e,...t];return n}getAttributes(e){let t=this.isKind(e,"JsxElement"),n=this.isKind(e,"JsxSelfClosingElement"),o=this.isKind(e,"JsxExpression");if(!e||!t&&!n&&!o)throw"Not valid node to get attributes";return t?this.getJsxElementAttributes(e):n?this.getJsxSelfClosingElementAttributes(e):o?[]:void 0}getJsxAttribute(e,t){if(!e||!this.isKind(e,"JsxElement")&&!this.isKind(e,"JsxSelfClosingElement"))throw"Error node provided is not a JsxElement or JsxSelfClosingElement, can't get the specified attribute";let n=this.getAttributes(e).find(e=>e.getNameNode().getText()==t);if(!n)throw"Can't get attribute ".concat(t);return n}getAttributeKey(e){if(!e||!this.isKind(e,"JsxAttribute"))throw"Can't get attribute key, the node provided isn't a JsxAttribute";return e.getNameNode().getText()}getAttributeValue(e){if(!e||!this.isKind(e,"JsxAttribute"))throw"Can't get attribute value, the node provided isn't a JsxAttribute";return e.getInitializer()}getJsxElementAttributes(e){if(!e||!this.isKind(e,"JsxElement"))throw"Error node provided is not a JsxElement, can't get its attributes";return e.getOpeningElement().getAttributes()}getJsxSelfClosingElementAttributes(e){if(!e||!this.isKind(e,"JsxSelfClosingElement"))throw"Error node provided is not a JsxSelfClosingElement, can't get its attributes";return e.getAttributes()}getJsxElementName(e){let t=this.isKind(e,"JsxElement"),n=this.isKind(e,"JsxSelfClosingElement"),o=this.isKind(e,"JsxExpression");if(!e||!t&&!n&&!o)throw"Not valid node to get Name";return t?this.getJsxElementIdentifier(e):n?this.getJsxSelfClosingElementIdentifier(e):o?{name:"ReactCode"}:void 0}getJsxElementIdentifier(e){if(!e||!this.isKind(e,"JsxElement"))throw"Error node provided is not a JsxElement, can't get its Identifier";let t=e.getOpeningElement(),n=t.getTagNameNode(),o=n.getText();return{node:n,name:o}}getJsxSelfClosingElementIdentifier(e){if(!e||!this.isKind(e,"JsxSelfClosingElement"))throw"Error node provided is not a JsxSelfClosingElement, can't get its Identifier";let t=e.getTagNameNode(),n=t.getText();return{node:t,name:n}}getJsxChildren(e){if(this.isKind(e,"JsxSelfClosingElement"))throw"Can't obtain children from JsxSelfClosingElement";if(!e||!this.isKind(e,"JsxElement"))throw"Can't obtain node children";let t=e.getChildrenOfKind(Q.lGB.SyntaxList)[0],n=t.getChildren();return n}getJsxTextOfJsxElement(e){if(this.isKind(e,"JsxExpression")||this.isKind(e,"JsxSelfClosingElement"))return;let t=this.getJsxChildren(e);if(t.length&&this.isKind(t[0],"JsxText"))return t[0]}getJsxChildrenFirstLevel(e){if(!(this.isKind(e,"JsxSelfClosingElement")||this.isKind(e,"JsxExpression")))return this.getJsxChildren(e).filter(e=>this.isKind(e,"JsxElement")||this.isKind(e,"JsxSelfClosingElement")||this.isKind(e,"JsxExpression"))}getAllJsxChildren(e){var t;let n;try{(n=this.getJsxChildrenFirstLevel(e)).forEach(e=>{n=[...n,...this.getAllJsxChildren(e)]})}catch(e){}return null!==(t=null==n?void 0:n.sort((e,t)=>e.getPos()-t.getPos()))&&void 0!==t?t:[]}isKind(e,t){return t==e.getKindName()}getNodeData(e){let t=this.getJsxElementName(e).name,n=this.getAttributes(e),o={},i={_nodeType:e.getKindName()};n.forEach(e=>{let t=this.getAttributeKey(e),n=this.getAttributeValue(e),{value:r,nodeKind:l,contextId:s}=this.nodeValueFactory(n);r&&t&&(o={...o,[t]:r}),l&&t&&(i={...i,[t]:l}),s&&t&&(i={...i,context:{...null==i?void 0:i.context,[t]:s}})});let r=this.getJsxTextOfJsxElement(e);return r&&r.getText()&&(o={...o,children:r.getText()},i={...i,children:"StringLiteral"}),{type:{resolvedName:t},isCanvas:!0,props:o,displayName:t,custom:i,hidden:!1,nodes:[],linkedNodes:{}}}flatten(e,t,n){var o;if(!e||!this.isKind(e,"JsxElement")&&!this.isKind(e,"JsxSelfClosingElement")&&!this.isKind(e,"JsxExpression"))return;let i=null!==(o=this.getIdentifier(e))&&void 0!==o?o:this.getIdFromSourceCode(e),r=this.getNodeData(e),l=[],s=this.getJsxChildrenFirstLevel(e);for(let e=0;e<(null==s?void 0:s.length);e++){let n=s[e];l.push(this.flatten(n,t,i))}let a={...r,nodes:l,parent:n};return t[i]=a,i}getNodes(e){if(!e||!this.isKind(e,"JsxElement"))throw"Can't getNodes from the give node that has no kind of type JsxElement";let t={};if(this.flatten(e,t,"ROOT"),!e||!this.isKind(e,"JsxElement"))throw"Can't getNodes from the give node that has no kind of type JsxElement";return t}toCraftNodes(e){var t;let n={type:{resolvedName:"Root"},isCanvas:!0,props:{"data-cy":"root-container"},displayName:"Root",custom:{},hidden:!1,nodes:[],linkedNodes:{}},o=this.getNodes(e),i=null===(t=Object.keys(o))||void 0===t?void 0:t.find(e=>"ROOT"==o[e].parent),r={};return i?(n={...n,nodes:[...n.nodes,i]},r={...o,ROOT:n}):r={ROOT:n},r}addCustomProps(e){let t=this.getImportDeclarations(),n={};return Object.keys(e).forEach(o=>{let i=e[o],r=this.getDisplayNameInNamedImports(i.displayName,t),l={...i,custom:{...i.custom,...r}};n={...n,[o]:l}}),n}getImportDeclarations(){let e=this.ast.getImportDeclarations(),t=[];return e.forEach(e=>{var n,o;let i=e.getNamedImports().length?e.getNamedImports():void 0,r=null==i?void 0:i.map(e=>{var t;return{name:e.getName(),alias:null===(t=e.getAliasNode())||void 0===t?void 0:t.getText()}}),l=null===(n=e.getDefaultImport())||void 0===n?void 0:n.getText(),s=null===(o=e.getModuleSpecifier())||void 0===o?void 0:o.getText();t=[...t,{namedImports:r,defaultImport:l,moduleSpecifier:s}]}),t}getDisplayNameInNamedImports(e,t){for(let n=0;n<(null==t?void 0:t.length);n++){let o=t[n],i=null==o?void 0:o.namedImports,r=null==o?void 0:o.defaultImport,l=null==o?void 0:o.moduleSpecifier;if(r===e)return{defaultImport:e,moduleSpecifier:l};if(i)for(let t=0;t<(null==i?void 0:i.length);t++){let n=i[t],o=null==n?void 0:n.name,r=null==n?void 0:n.alias;if(r===e||o===e)return{namedImportName:o,namedImportAlias:r,moduleSpecifier:l}}}return{}}identifyElements(e){let t=this.getAllJsxElements(this.getContent());for(let n=0;n<t.length;n++){let o,i="";t=this.getAllJsxElements(this.getContent());let r=this.getAttributes(t[n]);try{this.getJsxAttribute(t[n],"_nodeId")}catch(o){i+=' _nodeId="'.concat(e?e():this.getSameIdAsFlows(t[n]),'" ')}o=r.length?r[0].getStart():this.getJsxElementName(t[n]).node.getEnd(),this.ast.insertText(o,e=>e.write(i))}return this}getIdentifier(e){try{let t=this.getJsxAttribute(e,"_nodeId"),n=this.getAttributeValue(t);return this.nodeValueFactory(n).value}catch(e){console.error("Could not find node identifier")}}unidentifyElements(){let e=this.getAllJsxElements(this.getContent());for(let t=0;t<e.length;t++){e=this.getAllJsxElements(this.getContent());try{let n=this.getJsxAttribute(e[t],"_nodeId");this.ast.removeText(n.getStart(),n.getEnd())}catch(e){}}return this}getJsxElementByIdentifier(e,t){let n=this.getAllJsxElements(e),o=n.find(e=>this.getIdentifier(e)==t);if(!o)throw'Could not find element specified with uuid "'.concat(t,'" in the provided node');return o}convertJsxExpressionToJsxElement(){let e=()=>{let e=this.getContent();return this.getAllJsxElements(e).filter(e=>"JsxExpression"==e.getKindName())},t=n=>{n.length&&(this.ast.replaceText([n[0].getPos(),n[0].getEnd()],""),t(e()))};return t(e()),this}reactElementFactory(e,t){let n;let o=e.displayName;if("ReactCode"===o){let t=e.props.codeBlock;n="".concat(t)}else{let i,r="";if(Object.keys(e.props).filter(e=>!["_nodeId"].includes(e)).forEach(t=>{let n=e.props[t];if("StringLiteral"==e.custom[t]&&"children"!=t&&(n='"'.concat(n,'"')),"children"==t){i=n;return}void 0===n?r+=" ".concat(t):r+=" ".concat(t,"=").concat(n)}),"JsxSelfClosingElement"===e.custom._nodeType){let e=i?' children="'.concat(i,'"'):"";n="<"+"".concat(o)+r+e+"/>"}else n="<"+"".concat(o)+r+">"+"".concat(null!=i?i:"")+t+"</"+"".concat(o)+">"}return n}nodeValueFactory(e){let t;var n,o,i,r,l=null==e?void 0:e.getKindName();if("StringLiteral"===l)t=null==e?void 0:e.getLiteralValue();else{let s=null==e?void 0:e.getExpression(),a=null==s?void 0:s.getKindName();switch(a){case"StringLiteral":case"NumericLiteral":case"TrueKeyword":case"FalseKeyword":t=s.getLiteralValue(),l=a;break;case"ObjectLiteralExpression":let d=s.getProperties().reduce((e,t)=>{var n,o,i=t.getName();try{n=null===(o=t.getInitializer())||void 0===o?void 0:o.getLiteralValue()}catch(e){n=t.getInitializer().getText()}return{...e,[i]:n}},{});t=d,l=a;break;case"Identifier":if((null===(o=this.metadata)||void 0===o?void 0:o.context)&&(null===(i=this.metadata)||void 0===i?void 0:i.context[s.getText()])!=void 0){t=null===(r=this.metadata)||void 0===r?void 0:r.context[s.getText()],n=s.getText();break}default:t=null==e?void 0:e.getText()}}return{value:t,nodeKind:l,contextId:n}}getIdFromSourceCode(e){try{return e.getKindName()+"_"+e._compilerNode.pos+"_"+e._compilerNode.end}catch(t){return e}}constructor(e,t){this.ast=e,this.metadata=t}}var V=n(64509);class H extends s.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){if(this.state.hasError){var e;return(0,l.jsx)("div",{style:{height:"100vh",justifyContent:"center",alignItems:"center"},className:"  _dsp-flex _ai-stretch _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:(0,l.jsxs)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _w-8037 _maw-600px _ai-center ",children:[(0,l.jsx)("span",{className:"  _ff-299667014 _dsp-inline _bxs-border-box _ww-break-word _whiteSpace-pre-wrap _mt-0px _mr-0px _mb-0px _ml-0px _col-675002279 font_body ",children:"Can not render Visual UI frame due the following error:"}),(0,l.jsx)("span",{className:"  _ff-299667014 _dsp-inline _bxs-border-box _ww-break-word _whiteSpace-pre-wrap _mt-10px _mr-0px _mb-0px _ml-0px _col-red font_body ",children:null===(e=this.state.error)||void 0===e?void 0:e.message})]})})}return this.props.children}constructor(e){super(e),this.state={hasError:!1}}}n(18242);var M=n(28261),U=n.n(M),$=n(29691),W=n.n($),q=n(24757),X=n(71299),G=n(83735),Y=n(752);function ee(e){return(0,d._i)(e)}function et(e){let t=null!=e?e:null;return t?(0,Y.KO)(t):[null,null]}function en(e,t,n){if(e){let[o]=(0,Y.KO)(e),[i,r]=(0,s.useState)(null),[l,a]=(0,s.useState)(null),[d,c]=(0,s.useState)(null!=n?n:null);return(0,s.useEffect)(()=>{o&&o.subscribe&&o.subscribe(e=>{c(e=>{let n=t&&t(e,o);return null!=n?n:e})},()=>{})},[o]),(0,s.useEffect)(()=>{if(o.history.timeline.length<1)return;if(null===l&&null===i){r(o.query.serialize());return}let e=JSON.parse(o.query.serialize()),t=Z().diff(JSON.parse(i),e);if(!(t.length<1)){if(t.find(e=>"N"==e.kind))console.log("[useVisualUi] Event: new"),a({action:"add-node"});else if(t.find(e=>"D"==e.kind)){console.log("[useVisualUi] Event: delete");let e=t.filter(e=>"D"==e.kind).map(e=>e.path[0]),n=t.find(e=>"A"==e.kind).path[0];a({action:"delete-node",deletedNodes:e,parent:n})}else if(t.find(e=>"E"==e.kind)){let e=t.find(e=>"E"==e.kind&&"parent"==e.path[1]),o=t.find(e=>"E"==e.kind&&"children"==e.path[2]),r=t.find(e=>"E"==e.kind&&"props"==e.path[1]),l=t.find(e=>"E"==e.kind&&"nodes"==e.path[1]);if(o||r){console.log("[useVisualUi] Event: edit");let e=o?"children":"prop";var n,s="children"==e?o:r;let t=s.path[0],i=s.rhs;a({action:"edit-node",nodeId:t,value:i,type:e,field:s.path[2]})}else if(e){console.log("[useVisualUi] Event: move (diff parent)");let o=e.path[0],r=e.rhs,l=e.lhs,s=JSON.parse(i)[l].nodes.findIndex(e=>e==o),d=t.find(e=>"E"==e.kind&&e.path[0]==r&&e.rhs==o),c=null!==(n=null==d?void 0:d.path[2])&&void 0!==n?n:-1;a({action:"move-node",isSameParent:!1,nodeId:o,oldParentId:l,newParentId:r,newPos:c,oldPos:s})}else{console.log("[useVisualUi] Event: move (same parent)");let e=l.path[0],n=t.sort((e,t)=>e.path[2]-t.path[2]).map(e=>e.rhs),o=JSON.parse(i)[e].nodes,r=ed(o,n);a({action:"move-node",isSameParent:!0,parent:e,childrenIndexes:r})}}}},[o.query.serialize()]),{actions:o.actions,query:o.query,state:d,lastEvent:l}}throw Error("useVisualUi(...) must have a defined atom")}function eo(){let e=new URLSearchParams(window.location.search),t=e.get("experimental_comms");return"true"===t}function ei(e,t,n,o,i){let{actions:r,query:l}=e,{resolveComponentsDir:a,appendNewNodeToTree:d}=t;if(eo()){console.log("protocraft experimental communications");let{lastEvent:e}=en(i);(0,s.useEffect)(()=>{console.log("craftEvent: ",e)},[e])}else console.log("protocraft legacy communications"),(0,s.useEffect)(()=>{let e=o.action,t=o.nodeId,i=o.value,s=o.param;switch(e){case"delete-node":var c;if(!["JsxElement","JsxSelfClosingElement"].includes(o.deletedNodeType))return;r.setOptions(e=>e.skipTopic=!0),null===(c=o.nodesToDelete)||void 0===c||c.forEach(e=>r.delete(e)),n(JSON.parse(l.serialize()));break;case"delete-data":if(!s)return;try{r.setOptions(e=>e.skipTopic=!0),r.setProp(t,e=>(delete e[s],e)),n(JSON.parse(l.serialize()))}catch(e){console.error("error deleting data. ",e)}break;case"edit-data":if(!s)return;try{r.setOptions(e=>e.skipTopic=!0),r.setProp(t,e=>e[s]=i),r.setCustom(t,e=>e[s]="JsxText");let e=null==o?void 0:o.deleteKey;e&&r.setProp(t,t=>(delete t[e],t)),n(JSON.parse(l.serialize()))}catch(e){console.error("error editing data. ",e)}break;case"add-data":let u=JSON.parse(l.serialize());if(!u[t])return;try{u[t]={...u[t],props:{...u[t].props,[s]:i}},r.setOptions(e=>e.skipTopic=!0),r.setProp(t,e=>e[s]=i),n(u)}catch(e){console.error("error adding data. ",e)}break;case"add-node":let p=o.type,h=o.childrenPos,f=o.nodeName,x=o.parent;if("JsxElement"==p){let e={displayName:f,props:{},custom:{defaultImport:f,moduleSpecifier:'"'.concat(a).concat(f,'"'),_nodeType:"JsxElement"},hidden:!1,isCanvas:!0,parent:x,type:{resolvedName:f},nodes:[]},o=JSON.parse(l.serialize());if(!x||!o)return;try{let i=d(o,t,e,x,h);r.setOptions(e=>e.skipTopic=!0),r.deserialize(i),n(JSON.parse(l.serialize()))}catch(e){console.error("error adding node (JsxElement). ",e)}}else try{let e=o.data;if(!(null==e?void 0:e.isAncestorJsxElement))return;r.setOptions(e=>e.skipTopic=!0),r.setProp(x,t=>t[e.key]=e.value),n(JSON.parse(l.serialize()))}catch(e){console.error("error adding node (Not a JsxElement). ",e)}}},[o])}let er="flows-ui",el=(0,q.e)(er),es=e=>(0,l.jsx)(el,{...e,flowId:er,enableCommunicationInterface:function(t){let{edges:n,nodeData:o,nodes:i,setEdges:r,setNodesData:l,deleteNodes:a,setNodes:d,createNode:c,setNodeData:u,_customComponents:p,onSaveNodes:h,flowId:f,data:x}=t;if(eo()){console.log("flows: experimental communications");let{lastEvent:t}=en(e.contextAtom);(0,s.useEffect)(()=>{if(console.log("lastEvent: ",t),t)switch(t.action){case"add-node":case"delete-node":break;case"edit-node":{var e;console.log("visual event: edit-node");let n=t.field,i=t.value,r=t.nodeId;e="prop"==t.type?{["prop-"+n]:{...o[r]["prop-"+n],value:i,key:n,kind:(0,X.GT)(i)}}:{"child-1":i},l({...o,[r]:{...o[r],...e}});break}default:throw Error("useVisualUi(...): Unhandled event type")}},[t])}else console.log("flows: legacy communications"),(0,s.useEffect)(()=>{let e=x[f+"/ui"];if(e){var t=e.nodeId;switch(e.action){case"delete-node":var s,h=null!==(s=e.deletedNodes)&&void 0!==s?s:[],g=e.parent;let{updatedEdges:f,newNodeData:x}=a(h,g,t,n,o);r(f),l(x),d(e=>e.filter(e=>!h.includes(e.id)));break;case"add-node":var m,v,y=e.nodeName,b=e.parent,E=null!==(v=null==e?void 0:e.data)&&void 0!==v?v:{},C=null===(m=i.find(t=>t.id==e.parent))||void 0===m?void 0:m.position;if(!C)return;var w=e.childrenPos+1,k=e.nodeProps;let _=Object.keys(k).reduce((e,t)=>{var n=k[t],o="prop-".concat(t);let i=(0,X.GT)(n);var r={key:t,value:n,kind:i};return"children"==t&&(o="child-1",r=n),{...e,[o]:r}},{name:y});var j={...o,[t]:_};if(p.find(e=>e.id==y)){var A={};j={...j,[t]:{...j[t]}}}let J=c([C.x+500,C.y],"JsxElement",e.nodeId,E,!0,{},A);d(e=>e.concat(J));let I=(0,G.wo)(i,n,j,t,"JsxElement");l(j={...j,[b]:{...(0,G.MR)(j[b],w,null!=I?I:'"children"')}}),r((0,G.lm)(n,t,b,w));break;case"edit-node":let N=e.field,P=e.value;S="prop"==e.type?{["prop-"+N]:{...o[t]["prop-"+N],value:P,key:N,kind:(0,X.GT)(P)}}:{"child-1":P};var S,j={...o,[t]:{...o[t],...S}};l(j);break;case"move-node":let O=e.isSameParent;if(O){let t=e.parent,i=e.childrenIndexes,l=Math.min(...i),s={...o[t]},a=(0,G.ro)(s,i,l);u(t,a);let d=(0,G.lh)(n,t,l,i);r(d);return}{let i=e.oldParentId,s=e.oldPos+1,a=o[i],{data:d,deletedElementData:c}=(0,G.ap)(a,s),u=e.newParentId,p=o[u];if(!p)return;let h=Object.keys(p).filter(e=>e.startsWith("child-")).length,f=-1==e.newPos?h+1:e.newPos+1,x=(0,G.MR)(p,f,c);l({...o,[i]:d,[u]:x});let g=(0,G.cV)(n,t,i,s,u,f);r(g)}}}},[x[f+"/ui"]]),(0,s.useEffect)(()=>{var e;(null===(e=x.savenodes)||void 0===e?void 0:e.value)&&h()},[x.savenodes])}}),ea=(e,t,n)=>{e.debounce&&!eo()?(r=setTimeout(()=>{t(er+"/ui",e)},1e3),o&&e.nodeId==o.nodeId&&clearTimeout(i),o=e,i=r):t(er+"/ui",e),n&&n()};function ed(e,t){let n=[],o={};for(let t=0;t<e.length;t++)o[e[t]]=t;for(let e=0;e<t.length;e++){let i=t[e];n.push(o[i])}return n}let ec=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"customCode.tsx",n=new Q.IKL({useInMemoryFileSystem:!0,manipulationSettings:{indentationText:Q.xI4.Tab},compilerOptions:{target:Q.H7j.Latest,scriptKind:Q.hVH.TSX,languageVariant:Q.C$L.JSX}}),o=n.createSourceFile(t,e,{overwrite:!0});return o},eu=(e,t,n)=>{var o,i;let r=null===(o=e.filter(e=>"ImportDeclaration"==e.type))||void 0===o?void 0:o.map(e=>e.id),l=null===(i=e.filter(e=>["JsxElement","JsxSelfClosingElement"].includes(e.type)))||void 0===i?void 0:i.map(e=>e.id),s=[];r.forEach(e=>{let n=t[e],o=n.module;Object.keys(n).forEach(e=>{let t;"default"==e&&n[e]?(t={defaultImport:n.default,moduleSpecifier:o},s.push(t)):e.startsWith("import-")&&n[e]&&(t={namedImports:[{name:n[e],alias:void 0}],moduleSpecifier:o},s.push(t))})});let a=[];function d(e){for(let t of s){if(t.defaultImport===e)return!0;if(t.namedImports){for(let n of t.namedImports)if(n.name===e)return!0}}return!1}e.forEach(e=>{l.includes(e.id)&&a.push({...e.data,tagName:t[e.id].name})});let c=function(){let e=[];for(let t of a){let{tagName:n,namedImports:o,defaultImport:i}=t;d(n)||o||i||e.push({defaultImport:n}),!d(n)&&(o||i)&&e.push(t)}return e}();return c};var ep=n(66160);let eh={mobile:{marginTop:50,width:"360px",height:"740px"},tablet:{marginTop:50,width:"820px",height:"1680px"},desktop:{width:"100%",height:"100%"}};var ef=n(57643),ex=(0,V.Ic)(e=>{var t,o,i,r,a,c,u;let{frame:p="desktop",topics:h,currentPageContent:f,resolveComponentsDir:x,onReady:g=()=>{},metadata:m={},contextAtom:v=null,codeRef:y}=e,b=(0,s.useRef)(),[E,C]=(0,s.useState)(!0),[w,k]=(0,s.useState)({}),[j,A]=(0,s.useState)({}),[S,_]=(0,s.useState)(),{publish:J,data:I}=h,{actions:N,query:P,connectors:O}=(0,d.jE)((e,t)=>{let n=JSON.parse(t.serialize()),o=Z().diff(w,JSON.parse(t.serialize()));_(null===(a=e.events.selected)||void 0===a?void 0:a.keys().next().value);let i=(null==o?void 0:o.length)>0,l=Z().diff(j,n);if(!t.getOptions().skipTopic&&(null==l?void 0:l.length)&&JSON.stringify(l)!=r){var s={};if(1==l.filter(e=>"N"==e.kind).length){let e=l.find(e=>"N"==e.kind),t="props"==e.path[1],o=e.path[0];if(t)s={action:"edit-node",nodeId:o,value:e.rhs,type:"prop",field:e.path[2]};else{let e=n[o].parent,t=n[e].nodes.findIndex(e=>e==o),i=n[o].custom;s={action:"add-node",nodeId:o,nodeName:n[o].displayName,parent:e,childrenPos:t,data:i,nodeProps:n[o].props}}ea(s,J)}else if(l.find(e=>"D"==e.kind)){let e=l.filter(e=>"D"==e.kind).map(e=>e.path[0]),t=l.find(e=>"A"==e.kind).path[0];ea(s={action:"delete-node",deletedNodes:e,parent:t},J)}else if(l.find(e=>"E"==e.kind)){let e=l.find(e=>"E"==e.kind&&"parent"==e.path[1]),t=l.find(e=>"E"==e.kind&&"children"==e.path[2]),n=l.find(e=>"E"==e.kind&&"props"==e.path[1]),o=l.find(e=>"E"==e.kind&&"nodes"==e.path[1]);if(t||n){let e=t?"children":"prop";var a,d,c="children"==e?t:n;let o=c.path[0],i=c.rhs;s={action:"edit-node",nodeId:o,value:i,type:e,field:c.path[2],debounce:"children"==e}}else if(e){let t=e.path[0],n=e.rhs,o=e.lhs,i=j[o].nodes.findIndex(e=>e==t),r=l.find(e=>"E"==e.kind&&e.path[0]==n&&e.rhs==t),a=null!==(d=null==r?void 0:r.path[2])&&void 0!==d?d:-1;s={action:"move-node",isSameParent:!1,nodeId:t,oldParentId:o,newParentId:n,newPos:a,oldPos:i}}else{let e=o.path[0],t=l.sort((e,t)=>e.path[2]-t.path[2]).map(e=>e.rhs),n=j[e].nodes,i=ed(n,t);s={action:"move-node",isSameParent:!0,parent:e,childrenIndexes:i}}ea(s,J)}r=JSON.stringify(l),A(n)}return{hasChanges:i,currentEditorNodes:n,enabled:e.options.enabled}});(0,s.useEffect)(()=>{S&&J("zoomToNode",{id:S})},[S]),ei({actions:N,query:P},{resolveComponentsDir:x,appendNewNodeToTree:(e,t,n,o,i)=>(e[t]=n,e[o].nodes.splice(i,0,t),e)},A,I["flow/editor"],v,m.context),(0,s.useEffect)(()=>{N.setOptions(e=>e.skipTopic=!1)},[j]);let T=async e=>{let t=F.parse(e,m),n=t.data();k(n);let o=null!==(l=null==P?void 0:null===(r=P.getOptions())||void 0===r?void 0:r.resolver)&&void 0!==l?l:{},i=Object.keys(o);try{var r,l,s={};Object.keys(n).forEach(e=>{if(!i.includes(n[e].displayName)){let t={...n[e],custom:{...n[e].custom,unknown:!0},type:{...n[e].type,resolvedName:"Unknown"}};s[e]=t}}),N.deserialize({...n,...s})}catch(e){throw"Error loading editor nodes"}};return(0,L.Z)(["z","Z","s","S","c","C","Delete","Backspace"],e=>{var t,n;let o=(null===(n=b.current)||void 0===n?void 0:null===(t=n.getBoundingClientRect())||void 0===t?void 0:t.height)>0;if(o){if(("z"==e.key||"Z"==e.key)&&(e.ctrlKey||e.metaKey)&&e.shiftKey){try{N.history.redo()}catch(e){console.error("can not redone action")}return}if(("z"==e.key||"Z"==e.key)&&(e.ctrlKey||e.metaKey)){try{N.history.undo()}catch(e){console.error("can not undone action")}return}}}),(0,s.useEffect)(()=>{let e=async t=>{try{await T(f)}catch(n){t<10?(setTimeout(()=>e(t+1),5e3),C(!0)):console.error("Max retry reached! Error deserializing editor nodes (CraftJS nodes). Error: ".concat(n)),console.error("Error deserializing editor nodes (CraftJS nodes). Error: ".concat(n))}};f&&(C(!1),e(0))},[f]),(0,ef.rf)(()=>{let e=JSON.parse(P.serialize()),t=Object.keys(e),n=t.filter(t=>{var n;return null===(n=e[t].custom)||void 0===n?void 0:n.context});0!=n.length&&(N.setOptions(e=>e.skipTopic=!0),n.forEach(t=>{var n;Object.keys(null===(n=e[t].custom)||void 0===n?void 0:n.context).forEach(e=>{N.setProp(t,t=>t[e]=m.context[e])})}),A(JSON.parse(P.serialize())))},[m.context]),(0,l.jsxs)("div",{style:{backgroundColor:"rgb(50, 50, 50)",overflow:"hidden",flex:1,display:"flex",flexDirection:"column"},children:[(0,l.jsxs)(K(),{children:[(0,l.jsx)("title",{children:"Platform UI"}),(0,l.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:n(72555)})]}),E?(0,l.jsx)("div",{style:{height:"100vh",justifyContent:"center",alignItems:"center",zIndex:100,backgroundColor:"#f0f0f0"},className:"  _dsp-flex _ai-stretch _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:(0,l.jsx)(ep.$,{size:"large"})}):null,(0,l.jsx)("div",{onLoad:()=>C(!1),className:"page-container",style:{width:"100%",height:"100%",justifyContent:"center",alignItems:"center",overflow:"auto",overflowX:"hidden"},children:(0,l.jsx)("div",{id:"editor",className:"craftjs-renderer",ref:e=>{b.current=e,O.select(O.hover(e,null),null)},style:{flex:1,position:"relative",overflow:"auto",color:"black",backgroundColor:"#f0f0f0",margin:"0 auto",left:0,right:0,width:null!==(a=null===(t=eh[p])||void 0===t?void 0:t.width)&&void 0!==a?a:"100%",height:null!==(c=null===(o=eh[p])||void 0===o?void 0:o.height)&&void 0!==c?c:"100%",marginTop:null!==(u=null===(i=eh[p])||void 0===i?void 0:i.marginTop)&&void 0!==u?u:""},children:(0,l.jsx)(H,{children:(0,l.jsx)("div",{id:"editor-frame-container",children:(0,l.jsx)(d.RQ,{})})})})})]})},{topics:["flow/editor"]});n(1803);var eg=n(38880),em=n(88724);let ev=e=>{let{palettes:t,sendMessage:n,currentPage:o}=e,i=s.useRef(null),[r,a]=s.useState(""),{connectors:c,query:u}=(0,d.jE)(),p=Object.keys(t).reduce((e,n)=>{let o=t[n]?Object.keys(t[n]).filter(e=>{var o,i;return!(null===(i=t[n][e].craft)||void 0===i?void 0:null===(o=i.custom)||void 0===o?void 0:o.hidden)}).reduce((e,o)=>{var i,r,l,s;return{...e,[o]:{dropable:!0,element:t[n][o],icon:(i=t[n][o],s="Component",(null==i?void 0:null===(r=i.craft)||void 0===r?void 0:r.custom)&&(null==i?void 0:null===(l=i.craft)||void 0===l?void 0:l.custom.icon)&&(s=i.craft.custom.icon),s)}}},{}):{...e};return{...e,[n]:o}},{}),h=r?Object.keys(p).reduce((e,t)=>{let n=p[t],o=Object.keys(n),i=o.filter(e=>e.toLocaleLowerCase().includes(r.toLocaleLowerCase())).reduce((e,t)=>({...e,[t]:n[t]}),{});var l={};return Object.keys(i).length&&(l={[t]:i}),{...e,...l}},{}):p,f=Object.keys(h).filter(e=>"craft"!=e);function x(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=.95*window.innerHeight;i.current&&(i.current.style.height=e+"px",i.current.style.maxHeight=e+"px")}return s.useEffect(()=>(x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)),[]),(0,l.jsx)("div",{className:"visualui-sidebar",style:{backgroundColor:"rgb(37, 37, 38, 0.97)"},children:(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",flex:1,padding:"4px"},children:(0,l.jsxs)("div",{ref:i,style:{padding:"4px",display:"flex",flexDirection:"column",flex:1},children:[(0,l.jsx)("p",{style:{padding:"18px 0px 0px 14px",fontSize:"18px",color:"white",fontWeight:"400"},children:"Components"}),(0,l.jsxs)("div",{style:{display:"flex",margin:"18px 12px 18px 2px",position:"relative"},children:[(0,l.jsx)("input",{style:{fontFamily:"Jost-Regular",padding:"8px 8px 8px 36px",display:"flex",boxSizing:"border-box",fontSize:"14px",backgroundColor:"#323232",borderRadius:"10px",borderWidth:"0px",outline:"none",color:"white",flex:1},value:r,onChange:e=>a(e.target.value),placeholder:"Search..."}),(0,l.jsx)(eg.Z,{color:"grey",size:20,style:{position:"absolute",top:"8px",left:"10px"}}),r?(0,l.jsx)(em.Z,{onClick:()=>a(""),color:"white",size:20,style:{position:"absolute",top:"8px",right:"10px",cursor:"pointer"}}):null]}),(0,l.jsx)("div",{className:"visualui-sidebar-list",style:{overflow:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",flex:1},children:f.map((e,t)=>(0,l.jsxs)("div",{style:{flexDirection:"column",display:"flex",marginBottom:"25px"},children:[(0,l.jsx)("p",{style:{paddingLeft:"16px",marginBottom:"10px",fontSize:"12px",color:"grey"},children:e.toUpperCase()}),(0,l.jsx)("div",{className:"visualui-sidebar-list",style:{flex:1,display:"flex",justifyContent:"flex-start",flexWrap:"wrap",alignContent:"flex-start",gap:"8px"},children:Object.keys(h[e]).map((t,n)=>{let o=h[e][t];return(null==o?void 0:o.nonDeletable)?null:(0,l.jsx)("div",{onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#FFFFFF10"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=""},title:t,style:{display:"flex",cursor:"grab",borderRadius:"6px"},children:(0,l.jsxs)("div",{ref:e=>c.create(e,()=>o.dropable?(0,l.jsx)(d.W_,{is:o.element,canvas:!0}):s.createElement(o.element)),id:"drag-element-"+t,className:"draggable-element",style:{textAlign:"center",paddingTop:"10px",paddingBottom:"10px",width:"100px",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,l.jsx)(j,{name:o.icon,color:"#a8a29e",size:32}),(0,l.jsx)("div",{style:{marginTop:"14px"},children:(0,l.jsx)("p",{style:{fontSize:"12px",width:"100%",color:"white",padding:"5px"},children:t.length>12?t.substring(0,9)+"...":t})})]})},n)})})]},t))})]})})})};var ey=n(51745),eb=n(27911),eE=e=>{let{sourceCode:t,onChange:n,onSave:o,onEscape:i}=e;return o&&(0,L.Z)(["s","S"],e=>{if(("s"==e.key||"S"==e.key)&&(e.ctrlKey||e.metaKey)&&o)return e.preventDefault(),o()}),i&&(0,L.Z)(["Escape"],e=>{if("Escape"==e.key&&i)return e.preventDefault(),i()}),(0,l.jsx)(eb.ZP,{theme:"vs-dark",defaultLanguage:"javascript",value:t,onChange:e=>n(e)})},eC=n(53544),ew=n(91425),ek=n(43748),ej=n(8219),eA=n(89285),eS=n(34389),e_=n(98528),eJ=n(19456),eI=n(10406),eN=n(70698),eP=n(1674),eO=n(13410),eT=n(75780),ez=n(47401),eD=n(40144),eB=n(73235),eK=n(17788),eL=n(11001),eR=n(81395);function eZ(){let e=(0,eB._)(["\n  height: ",";\n  flex: ",";\n  color: #545454;\n"]);return eZ=function(){return e},e}let eQ=eK.default.div(eZ(),e=>e.visible&&e.height&&"full"!==e.height?"".concat(e.height):"auto",e=>e.visible&&e.height&&"full"===e.height?"1":"unset"),eF=e=>{let{visible:t,icon:n,title:o,children:i,height:r,onChange:a}=e,d=C("separatorColor");return(0,l.jsxs)(eQ,{visible:t,height:r,style:{display:"flex",flexDirection:"column"},children:[(0,l.jsxs)("div",{onClick:()=>{a&&a(!t)},style:{cursor:"pointer",backgroundColor:C("secondaryBackground"),borderBottom:"1px solid "+d,alignItems:"center",padding:"10px",flexDirection:"row",display:"flex"},children:[(0,l.jsxs)("div",{style:{display:"flex",flex:1,alignItems:"center"},children:[s.createElement(n,{size:18,color:C("textColor")}),(0,l.jsx)("div",{style:{fontSize:18,marginLeft:"10px",color:C("textColor")},children:o})]}),t?(0,l.jsx)(eL.Z,{size:18}):(0,l.jsx)(eR.Z,{size:18})]}),(0,l.jsx)("div",{style:{display:t?"flex":"none",flex:1,flexDirection:"column",overflowY:"scroll"},className:"  _dsp-flex _ai-stretch _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:i})]})};n(53235);var eV=n(15537),eH=n(37288);let eM="  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center _gap-1316330145 ",eU=e=>{let{icon:t,onPress:n,text:o,buttonProps:i={},id:r,item:a}=e,[d,c]=(0,s.useState)(!1);return(0,l.jsx)(eH.sL,{id:r,onPress:n,children:(0,l.jsx)(I,{trigger:(0,l.jsx)(ez.zx,{animation:"bouncy",chromeless:!0,paddingHorizontal:"$3",height:"40px",fontSize:"$5",borderRadius:"$2",icon:t,hoverStyle:{backgroundColor:"transparent"},color:d&&!i.theme?C("interactiveColor"):C("textColor"),onMouseEnter:e=>c(!0),onMouseLeave:e=>c(!1),scaleIcon:1.5,textProps:{...i.textProps},...i,children:o}),onOpenChange:()=>null,content:a.menu?a.menu.map((e,t)=>(0,l.jsx)(J,{icon:e.icon,name:e.text,onClick:e.onPress},t)):null,...a.menuProps})})};var e$=e=>{let{height:t,leftItems:n,rightItems:o,...i}=e;return(0,l.jsxs)(eH.sL,{jc:"space-between",ai:"center",backgroundColor:C("nodeBackgroundColor"),h:t,bbc:C("separatorColor"),bbw:"1px",paddingHorizontal:"$4",...i,children:[(0,l.jsx)("div",{className:eM,children:n.map((e,t)=>(0,l.jsx)(eU,{item:e,id:e.id,onPress:e.onPress,icon:e.icon,text:e.text,buttonProps:e.buttonProps},t))}),(0,l.jsx)("div",{className:eM,children:o.map((e,t)=>(0,l.jsx)(eU,{item:e,id:e.id,onPress:e.onPress,icon:e.icon,text:e.text,buttonProps:e.buttonProps},t))})]})};n(89603);var eW=n(50923),eq=n(28844);let eX=" _dsp-none",eG=" _dsp-flex";var eY=(0,s.memo)((0,V.Ic)(function(e){let{isActive:t=!0,sourceCode:n="",sendMessage:o,currentPage:i="",userPalettes:r={},resolveComponentsDir:u="",topics:p,metadata:h={},contextAtom:f=null}=e,[x,g]=et(f),m=(0,s.useRef)(),v=(0,s.useRef)(""),y=(0,s.useRef)(),[w,k]=(0,s.useState)(!1),[j,A]=(0,s.useState)(""),[S,_]=(0,s.useState)(j),[J,I]=(0,s.useState)(!1),[N,O]=(0,s.useState)("preview"),[T,z]=(0,s.useState)(!1),[B,K]=(0,s.useState)(!0),[L,R]=(0,s.useState)(!1),[Z,Q]=(0,s.useState)("desktop"),F=(0,a.useRouter)(),{resolvedTheme:V,toggle:H,current:M}=(0,b.P)(),{publish:U}=p,{data:$}=p,[W,q]=s.useState(!1),X="preview"==N,G="50px",Y="calc(100vh - "+G+")",en=C("separatorColor");(0,s.useEffect)(()=>{let e=()=>q(!1);return window.addEventListener("dragenter",e),()=>{window.removeEventListener("dragenter",e)}},[]);let eo={...D,...r},ei=Object.keys(eo).reduce((e,t)=>e={...e,...eo[t]},{}),er=async()=>{A(n)},el=async(e,t,n)=>{var i=t;switch(e){case"monaco":o({type:"save",data:{content:i=S}});break;case"flows":if(!n)break;let r=ec(i),l=r.getImportDeclarations(),s=eu(n.nodes,n.nodesData,u);if(s.length){let e=[...new Map(s.map(e=>[e.tagName,e])).values()],t=e.reduce((e,t)=>{var n,o,i,r,l;let s;let a=t.moduleSpecifier;if(a){if(null===(n=t.namedImports)||void 0===n?void 0:n.length){let e=(null===(o=t.namedImports[0])||void 0===o?void 0:o.alias)?(null===(i=t.namedImports[0])||void 0===i?void 0:i.name)+" as "+(null===(r=t.namedImports[0])||void 0===r?void 0:r.alias):null===(l=t.namedImports[0])||void 0===l?void 0:l.name;s="import {"+e+'} from "'+a+'";\n'}else t.defaultImport&&(s="import "+t.defaultImport+' from "'+a+'";\n')}else s="";return e+s},"\n"),n=l?l[l.length-1].getEnd():0,o=r.insertText(n,t);i=o.getText()}o({type:"save",data:{content:i}})}},ea=e=>{if("code"==e)w?z(!T):z(!0),O(void 0),k(!0);else if("flow"==e)N==e?z(!T):z(!0),O(e),k(!1);else if("preview"==e){let t=["flow-preview","preview"].includes(N);t?z(!T):z(!0),O(t?N:e),k(!1)}};(0,s.useEffect)(()=>{_(j)},[j]),(0,s.useEffect)(()=>{er()},[n]),(0,s.useEffect)(()=>{var e;(null===(e=$.zoomToNode)||void 0===e?void 0:e.id)&&!T&&z(!0)},[$.zoomToNode]);let ed=(0,l.jsx)("div",{style:{display:"flex",width:"100%",top:T?0:-1e12,position:T?"relative":"absolute",height:"100%"},children:(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:Y},children:[(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",zIndex:999999,backgroundColor:C("nodeBackgroundColor"),borderBottom:"1px solid "+en},children:[(0,l.jsx)(eW.Q,{name:"dark",children:(0,l.jsxs)("div",{className:(0,eq.Ej)(" _dsp-flex _ai-stretch _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _pt-10px _pr-10px _pb-10px _pl-10px _mt-1481558276 _mb-1481558276  "+(J&&w?eG:eX)),children:[(0,l.jsx)(ez.zx,{size:"$3",chromeless:!0,circular:!0,marginRight:"$2",onPress:()=>{_(j),I(!1)},children:(0,l.jsx)(em.Z,{})}),(0,l.jsx)(ez.zx,{size:"$3",chromeless:!0,circular:!0,onPress:()=>el("monaco",S),children:(0,l.jsx)(eC.Z,{fillOpacity:0})})]})}),(0,l.jsx)("div",{className:(0,eq.Ej)(" _dsp-flex _ai-stretch _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _pt-10px _pr-10px _pb-10px _pl-10px  "+(["flow-preview","preview"].includes(N)?eG:eX)),children:(0,l.jsxs)(eD.t,{borderWidth:"$0",theme:"dark"==V?"dark":"light",type:"single",defaultValue:"preview",disableDeactivation:!0,children:[(0,l.jsx)(eD.t.Item,{hoverStyle:{backgroundColor:"flow-preview"==N?C("interactiveHoverColorDarken"):C("interactiveHoverColor")},focusStyle:{backgroundColor:"flow-preview"==N?C("interactiveColor"):C("inputBackgroundColor")},backgroundColor:"flow-preview"==N?C("interactiveColor"):C("inputBackgroundColor"),value:"flow-preview",onPress:()=>O("flow-preview"),children:(0,l.jsx)(ew.Z,{fillOpacity:0,color:"flow-preview"==N&&"dark"!=V?C("nodeBackgroundColor"):C("textColor")})}),(0,l.jsx)(eD.t.Item,{hoverStyle:{backgroundColor:"preview"==N?C("interactiveHoverColorDarken"):C("interactiveHoverColor")},focusStyle:{backgroundColor:"preview"==N?C("interactiveColor"):C("inputBackgroundColor")},backgroundColor:"preview"==N?C("interactiveColor"):C("inputBackgroundColor"),value:"preview",onPress:()=>O("preview"),children:(0,l.jsx)(ek.Z,{fillOpacity:0,color:"preview"==N&&"dark"!=V?C("nodeBackgroundColor"):C("textColor")})})]})})]}),(0,l.jsx)("div",{style:{display:w?"flex":"none",flex:1},children:(0,l.jsx)(eE,{onChange:e=>{_(e),j!=e?I(!0):I(!1)},sourceCode:S})}),(0,l.jsxs)("div",{style:{opacity:1,marginRight:0,flex:1,display:w?"none":"flex",flexDirection:"column",backgroundColor:C("nodeBackgroundColor")},children:[(0,l.jsx)(eF,{icon:ej.Z,title:"Customize",height:L?"55%":"full",visible:B,onChange:e=>K(e),children:(0,l.jsx)(es,{disableDots:!t||X,sourceCode:j,setSourceCode:A,customComponents:(0,eV.B)(F.pathname,F.query),onSave:(e,t,n)=>el("flows",e,n),config:{masks:(0,eV.W)(F.pathname,F.query)},zoomOnDoubleClick:!X,themeMode:V,bgColor:"transparent",onEdit:e=>v.current=e,theme:E[V],nodePreview:N,metadata:h,contextAtom:f,defaultSelected:e=>Object.keys(null!=e?e:{}).find(t=>t.startsWith("JsxElement")&&"Page"==e[t].name)})}),(0,l.jsx)(eF,{icon:eA.Z,title:"Layers",visible:L,onChange:e=>R(e),height:B?"55%":"full",children:(0,l.jsx)(c.S9,{})})]})]})},"auxiliarySidebar"),ep=(0,l.jsx)("div",{style:{display:"flex",flex:1,height:"100%"},children:(0,l.jsx)(ev,{palettes:eo,sendMessage:o,currentPage:i})},"sidebar"),eh=(0,l.jsx)("div",{id:"editor-layout",style:{flex:1,display:"flex",minWidth:"280px",borderRight:"2px solid "+en},children:(0,l.jsx)(ex,{metadata:h,frame:Z,currentPageContent:j,codeRef:v,onSave:()=>null,resolveComponentsDir:u,contextAtom:f})});function ef(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=window.innerHeight;m.current&&(m.current.style.height=e+"px")}(0,s.useEffect)(()=>(ef(),window.addEventListener("resize",ef),()=>window.removeEventListener("resize",ef)),[]),(0,s.useEffect)(()=>{var e;let t=e=>{y.current||(e.preventDefault(),e.stopPropagation())};return null===(e=document.getElementById("editor-layout"))||void 0===e||e.addEventListener("click",t),()=>{var e;return null===(e=document.getElementById("editor-layout"))||void 0===e?void 0:e.removeEventListener("click",t)}},[]);let eg={resolver:ei,onRender:e=>{let{...t}=e;return P({...t,onEnableEvents:e=>{y.current=e},metadata:h})}},eb=ee(eg);return g&&g(eb),(0,l.jsx)("div",{ref:m,style:{display:"flex",flex:1,width:"100%",flexDirection:"column"},children:(0,l.jsxs)(d.ML,{...eg,parentContext:eb,children:[(0,l.jsx)(e$,{height:G,leftItems:[{id:"components-to-drag-btn",icon:eS.Z,buttonProps:{chromeless:!1,color:"white",backgroundColor:C("interactiveColor"),hoverStyle:{backgroundColor:C("interactiveHoverColorDarken")}},onPress:()=>q(!0)},{icon:"light"==M?e_.Z:"dark"==M?eJ.Z:eI.Z,onPress:H},{icon:eN.Z,text:"Exit",onPress:()=>{document.location.href=document.location.href.split("?")[0]},buttonProps:{variant:"outlined",chromeless:!1,borderWidth:"$0.5",borderColor:C("textColor"),hoverStyle:{variant:"outlined",chromeless:!1,borderWidth:"$0.5",borderColor:C("interactiveColor")}}}],rightItems:[{icon:eP.Z,onPress:()=>ea("code")},{icon:eO.Z,onPress:()=>ea("flow")},{id:"save-nodes-btn",icon:eC.Z,text:"Save",buttonProps:{chromeless:!1,color:"white",backgroundColor:C("interactiveColor"),paddingHorizontal:"$4",hoverStyle:{backgroundColor:C("interactiveHoverColorDarken")}},onPress:()=>U("savenodes",{value:"visual-ui"})},{icon:eT.Z,onPress:()=>ea("preview")}]}),(0,l.jsx)("div",{style:{display:"flex",flex:1,flexDirection:"row"},children:(0,l.jsx)(ey.Z,{openPanel:W,setOpenPanel:q,leftPanelContent:ep,centerPanelContent:eh,borderLess:!0,height:Y,rightPanelContent:ed,rightPanelResizable:!X,rightPanelWidth:X?0:50,rightPanelVisible:T})})]})})},{topics:["zoomToNode"]}));n(32644);var e0=e=>{let{userPalettes:t={},_sourceCode:n="",_resolveComponentsDir:o="@/uikit",_currentPage:i="",onSave:r=()=>null,metadata:a={},contextAtom:d}=e,[c,u]=(0,s.useState)(i),p=async e=>{let t=e.type,n=e.data;switch(t){case"loadPage":let o=n.pageName;u(o);break;case"save":let i=n.content;r(function(e){let t;try{t=W().format(e,{bracketSameLine:!0,jsxBracketSameLine:!0,singleAttributePerLine:!1,printWidth:1e3,quoteProps:"consistent",jsxSingleQuote:!1,parser:"typescript",plugins:[U()]})}catch(e){console.error("Could not format text. Error: "+e)}return null!=t?t:e}(i))}};return(0,l.jsx)(V.US,{children:n?(0,l.jsx)(eY,{sourceCode:n,currentPage:c,userPalettes:t,sendMessage:p,resolveComponentsDir:"".concat(o,"/"),metadata:a,contextAtom:d}):null})}},1803:function(){},53235:function(){},18242:function(){},32644:function(){},54975:function(){},89603:function(){}}]);